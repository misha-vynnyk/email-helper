#!/bin/bash
set -e

# –í–∏–∑–Ω–∞—á–∞—î–º–æ Node.js
NODE="${NODE:-/opt/homebrew/bin/node}"

# –Ø–∫—â–æ Node –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∑–∞ –≤–∫–∞–∑–∞–Ω–∏–º —à–ª—è—Ö–æ–º, —à—É–∫–∞—î–º–æ –≤ PATH
if [ ! -x "$NODE" ]; then
  NODE="$(command -v node || true)"
fi

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å Node.js
if [ ! -x "$NODE" ]; then
  echo "‚ùå –ü–æ–º–∏–ª–∫–∞: Node.js –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ"
  echo "–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Node.js –∞–±–æ –≤–∫–∞–∂—ñ—Ç—å —à–ª—è—Ö —á–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—É NODE"
  exit 1
fi

# –®–ª—è—Ö –¥–æ —Å–∫—Ä–∏–ø—Ç–∞
SCRIPT_DIR="$HOME/Documents/projects/automation/scripts"
SCRIPT="$SCRIPT_DIR/upload-playwright-brave.js"

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç–∞
if [ ! -f "$SCRIPT" ]; then
  echo "‚ùå –ü–æ–º–∏–ª–∫–∞: —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: $SCRIPT"
  exit 1
fi

# –û–±—Ä–æ–±–ª—è—î–º–æ –∫–æ–∂–µ–Ω —Ñ–∞–π–ª
for f in "$@"; do
  if [ ! -f "$f" ]; then
    echo "‚ö†Ô∏è –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ: —Ñ–∞–π–ª –Ω–µ —ñ—Å–Ω—É—î: $f"
    continue
  fi

  echo "üì§ –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: $f"

  # –ó–∞–≤–∂–¥–∏ –ø–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É –∑ –ø–µ—Ä–µ–¥–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è–º –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó Health
  # –î–ª—è –ø—Ä–æ–ø—É—Å–∫—É —Ñ–æ—Ä–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ: --no-confirm
  "$NODE" "$SCRIPT" "$f" "health"
done

echo "‚úÖ –û–±—Ä–æ–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
